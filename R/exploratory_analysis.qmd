---
title: "exploratory_analysis"
format: html
---

# Setting up data

```{r}
library(DEXSeq)
library(fgsea)
library(msigdbr)
library(stringr)

load(file='/home/projects/22140/exam_data/exam_functions.Rdata')

isoform_count_08 <-loadIsoformCountMatrix('GSE106608')
isoform_count_83 <-loadIsoformCountMatrix('GSE208783,GSE208784')

gene_count_08 <- extractGeneCountMatrixFromIsoCounts(isoform_count_08)
gene_count_83 <- extractGeneCountMatrixFromIsoCounts(isoform_count_83)

isoform_count_08 <- as.data.frame(isoform_count_08)
isoform_count_83 <- as.data.frame(isoform_count_83)

isoInfo <- read_rds(
paste0(
'/home/projects/22140/exam_data/',
'Homo_sapiens.GRCh38.107.chr_patch_hapl_scaff_tx_info.Rds'
)
)
```

### Meta data

```{r}
file_path_08 <- "../metadata_temporary/Template_group6_GSE106608.csv"

metadata_df_08 <- read.csv(
  file_path_08,
  skip = 6,
  stringsAsFactors = FALSE
)
colnames(meta_08)[5] <- "condition"

head(meta_08)
```

```{r}

metadata_df_08 <- metadata_df_08 |>
  mutate(gender = str_extract(characteristics, "(?<=Sex: )\\w$")
  )

head(metadata_df_08)

```

```{r}
file_path_83 <- "../metadata_temporary/Template_group6_GSE208783.csv"

metadata_df_83 <- read.table(
  file_path_83,
  sep = ";",          
  header = TRUE,
  skip = 6,
  stringsAsFactors = FALSE,
  quote = "\""         # Add this line to handle quoted fields
)

colnames(metadata_df_83)[5] <- "groups"
# Remove the "" from groups
metadata_df_83$groups <- gsub("\"", "", metadata_df_83$groups)
```
